<!-- /admin/index.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SEOBoss — Onboarding</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Optional: light styles so it looks decent -->
  <style>
    :root { --ink:#0b0f14; --fg:#e8fff6; --brand:#42ffd2; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, sans-serif; background:#0b0f14; color:#e8fff6; margin:0; }
    .wrap { max-width:720px; margin:40px auto; padding:0 16px; }
    .card { background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
            border-radius:16px; padding:20px; box-shadow:0 0 24px rgba(66,255,210,.18); }
    h1 { color:var(--brand); margin:0 0 8px; }
    p  { opacity:.92; }
    .row { display:flex; gap:10px; flex-wrap:wrap; margin:14px 0; }
    input { flex:1 1 260px; min-height:44px; border-radius:10px; border:1px solid rgba(255,255,255,.18);
            background:rgba(255,255,255,.06); color:#fff; padding:10px 12px; font-size:16px; }
    button { min-height:44px; border-radius:50px; padding:10px 16px; border:0; cursor:pointer;
             background:linear-gradient(90deg,#42ffd2,#6aa8ff); color:#031b17; font-weight:800; }
    .muted { opacity:.8; font-size:14px; }
    .ok { color:#42ffd2; font-weight:700; }
    .bad { color:#ff6b6b; font-weight:700; }
    .log { font-family:ui-monospace,Consolas,Menlo,monospace; font-size:14px; white-space:pre-wrap; margin-top:8px; opacity:.9; }
  </style>
  <!-- App Bridge init is optional here; page works without it -->
  <script type="module">
    // If Shopify passes ?shop=xxx, prefill the input.
    const params = new URLSearchParams(location.search);
    window.__SB_SHOP__ = params.get('shop') || '';

    // Expose a tiny helper to call your Netlify Functions
    window.sbCall = async function (fn, payload) {
      const res = await fetch(`/.netlify/functions/${fn}`, {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(payload || {})
      });
      const text = await res.text();
      let body;
      try { body = JSON.parse(text); } catch { body = text; }
      return { status: res.status, body };
    };
  </script>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>SEOBoss — Store Setup</h1>
      <p class="muted">Connect your Shopify store and kick off the initial blog import.</p>

      <div class="row">
        <input id="shopInput" placeholder="your-store.myshopify.com" />
        <button id="checkBtn">Check connection</button>
      </div>

      <div id="checkResult" class="log"></div>

      <div class="row">
        <button id="importBtn">Start blog import</button>
      </div>

      <div id="importResult" class="log"></div>
    </div>
  </div>

  <script>
    // Prefill shop if provided in query string by Shopify
    const shopInput = document.getElementById('shopInput');
    if (window.__SB_SHOP__) shopInput.value = window.__SB_SHOP__;

    document.getElementById('checkBtn').addEventListener('click', async () => {
      const shop = shopInput.value.trim();
      const out = document.getElementById('checkResult');
      out.textContent = 'Checking…';
      const {status, body} = await window.sbCall('check-shop', { shop });
      out.innerHTML = (status === 200 && body && body.ok)
        ? `<span class="ok">✅ Connected</span> — ${shop}`
        : `<span class="bad">❌ Not connected</span> — ${typeof body === 'string' ? body : JSON.stringify(body)}`;
    });

    document.getElementById('importBtn').addEventListener('click', async () => {
      const shop = shopInput.value.trim();
      const out = document.getElementById('importResult');
      out.textContent = 'Starting import…';
      const {status, body} = await window.sbCall('start-import', { shop });
      out.textContent = `Status ${status} — ${typeof body === 'string' ? body : JSON.stringify(body)}`;
    });
  </script>
</body>
</html>
